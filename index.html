<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Collection and Delivery Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    fieldset { margin-bottom: 15px; padding: 10px; }
    .hidden { display: none; }
    label { display: block; margin-top: 8px; }
  </style>
</head>
<body>
  <h1>Collection and Delivery Calculator</h1>
  <form id="calculatorForm">
    <!-- Client Type Section -->
    <fieldset>
      <legend>Client Type</legend>
      <label>
        <input type="checkbox" name="clientType" value="private" id="clientPrivate">
        Private Client
      </label>
      <label>
        <input type="checkbox" name="clientType" value="insurance" id="clientInsurance">
        Insurance
      </label>
    </fieldset>

    <!-- Private Client Section -->
    <div id="privateSection" class="hidden">
      <fieldset>
        <legend>Private Client Details</legend>
        <label>
          What is the total value of the items to be collected?
          <select id="privateTotalValue">
            <option value="">Select...</option>
            <option value="0-10000">£0 - £10,000</option>
            <option value="10001-20000">£10,001 - £20,000</option>
            <option value="20001-30000">£20,001 - £30,000</option>
            <option value="30001-40000">£30,001 - £40,000</option>
            <option value="40001-50000">£40,001 - £50,000</option>
            <option value="50000plus">£50,000+</option>
          </select>
        </label>
        <label>
          How many items are being collected?
          <input type="number" id="privateItemCount" min="1" value="1">
        </label>
        <label>
          What type of item/s are being collected?
          <br>
          <input type="radio" name="privateItemType" value="artwork"> Artwork
          <input type="radio" name="privateItemType" value="object"> Object
          <input type="radio" name="privateItemType" value="furniture"> Furniture
          <input type="radio" name="privateItemType" value="mixed"> Mixed
        </label>
      </fieldset>
      <fieldset>
        <legend>Second Person Required for Collection</legend>
        <label>
          <input type="radio" name="privateSecondPerson" value="no" checked> No
          <input type="radio" name="privateSecondPerson" value="advisable"> Advisable
          <input type="radio" name="privateSecondPerson" value="essential"> Essential
        </label>
      </fieldset>
      <fieldset>
        <legend>Crate Requirement</legend>
        <label>
          Is a crate required?
          <br>
          <input type="radio" name="privateCrateRequired" value="no" checked> No
          <input type="radio" name="privateCrateRequired" value="yes"> Yes
        </label>
      </fieldset>
      <fieldset id="privateCrateOptions" class="hidden">
        <legend>Crate Options</legend>
        <label>
          Select crate type:
          <br>
          <input type="radio" name="privateCrateType" value="inhouse"> In-house
          <input type="radio" name="privateCrateType" value="bespoke"> Bespoke
        </label>
      </fieldset>
      <!-- New Trip Type Section -->
      <fieldset>
        <legend>Trip Type</legend>
        <label>
          <input type="radio" name="privateTripType" value="oneway" checked> One-way
        </label>
        <label>
          <input type="radio" name="privateTripType" value="roundtrip"> Round Trip
        </label>
      </fieldset>
    </div>

    <!-- Insurance Section -->
    <div id="insuranceSection" class="hidden">
      <fieldset>
        <legend>Insurance Details</legend>
        <label>
          Was this collection part of a surge response?
          <br>
          <input type="radio" name="insuranceSurge" value="yes"> Yes
          <input type="radio" name="insuranceSurge" value="no" checked> No
        </label>
      </fieldset>
      <fieldset>
        <legend>Collection Route</legend>
        <label>
          Is collection/delivery on a normal route?
          <br>
          <!-- Neither option is preselected now -->
          <input type="radio" name="insuranceNormalRoute" value="yes"> Yes
          <input type="radio" name="insuranceNormalRoute" value="no"> No
        </label>
      </fieldset>
      <!-- If Normal Route is No, show dedicated collection details -->
      <div id="insuranceDedicated" class="hidden">
        <fieldset>
          <legend>Dedicated Collection Details</legend>
          <label>
            How many vans are being sent as part of a dedicated collection for this job?
            <input type="number" id="insuranceNumVans" min="0" value="0">
          </label>
          <label>
            How many additional people are being sent for this job?
            <input type="number" id="insuranceNumPeople" min="0" value="0">
          </label>
        </fieldset>
      </div>
      <!-- If Normal Route is Yes, show standard collection details -->
      <fieldset id="insuranceStandardDetails" class="hidden">
        <legend>Collection Details</legend>
        <label>
          Is a second person required for collection?
          <br>
          <input type="radio" name="insuranceSecondPerson" value="no" checked> No
          <input type="radio" name="insuranceSecondPerson" value="advisable"> Advisable
          <input type="radio" name="insuranceSecondPerson" value="essential"> Essential
        </label>
      </fieldset>
      <fieldset id="insuranceItemDetails" class="hidden">
        <legend>Item Details</legend>
        <label>
          What type of item/s are being collected?
          <br>
          <input type="radio" name="insuranceItemType" value="artwork"> Artwork
          <input type="radio" name="insuranceItemType" value="objects"> Objects
          <input type="radio" name="insuranceItemType" value="furniture"> Furniture
          <input type="radio" name="insuranceItemType" value="mixed"> Mixed
        </label>
        <label>
          How many item/s are being collected?
          <input type="number" id="insuranceNumItems" min="0" value="0">
        </label>
      </fieldset>
    </div>

    <button type="button" onclick="calculateTotal()">Calculate Total</button>
  </form>

  <h2 id="resultMessage">Total Price: £<span id="totalPrice">0.00</span></h2>

  <script>
    // Ensure only one client type checkbox is selected at a time.
    const privateCheckbox = document.getElementById('clientPrivate');
    const insuranceCheckbox = document.getElementById('clientInsurance');

    privateCheckbox.addEventListener('change', function() {
      if (this.checked) {
        insuranceCheckbox.checked = false;
        document.getElementById('privateSection').classList.remove('hidden');
        document.getElementById('insuranceSection').classList.add('hidden');
      } else {
        document.getElementById('privateSection').classList.add('hidden');
      }
    });

    insuranceCheckbox.addEventListener('change', function() {
      if (this.checked) {
        privateCheckbox.checked = false;
        document.getElementById('insuranceSection').classList.remove('hidden');
        document.getElementById('privateSection').classList.add('hidden');
      } else {
        document.getElementById('insuranceSection').classList.add('hidden');
      }
    });

    // For Private Client: show crate options if crate is required.
    document.getElementsByName('privateCrateRequired').forEach(radio => {
      radio.addEventListener('change', function() {
        const crateOptions = document.getElementById('privateCrateOptions');
        if (this.value === "yes") {
          crateOptions.classList.remove('hidden');
        } else {
          crateOptions.classList.add('hidden');
        }
      });
    });

    // For Insurance branch: show/hide dedicated or standard details based on the normal route answer.
    document.getElementsByName('insuranceNormalRoute').forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.value === 'no') {
          document.getElementById('insuranceDedicated').classList.remove('hidden');
          document.getElementById('insuranceStandardDetails').classList.add('hidden');
          document.getElementById('insuranceItemDetails').classList.add('hidden');
        } else {
          document.getElementById('insuranceDedicated').classList.add('hidden');
          document.getElementById('insuranceStandardDetails').classList.remove('hidden');
          document.getElementById('insuranceItemDetails').classList.remove('hidden');
        }
      });
    });

    function calculateTotal() {
      let total = 0;
      let priceOnAsking = false;
      const resultMessage = document.getElementById('resultMessage');
      resultMessage.style.color = "black"; // Reset styling

      // PRIVATE CLIENT CALCULATIONS
      if (privateCheckbox.checked) {
        // Retrieve values
        const totalValue = document.getElementById('privateTotalValue').value;
        const numItems = parseInt(document.getElementById('privateItemCount').value, 10);
        const itemTypeElem = document.querySelector('input[name="privateItemType"]:checked');
        if (!totalValue || !numItems || !itemTypeElem) {
          alert("Please complete all Private Client fields.");
          return;
        }
        // Determine base price based on total value range and number of items
        if (numItems <= 3) {
          switch(totalValue) {
            case "0-10000":
              total += 90;
              break;
            case "10001-20000":
              total += 120;
              break;
            case "20001-30000":
              total += 160;
              break;
            case "30001-40000":
              total += 210;
              break;
            case "40001-50000":
              total += 270;
              break;
            case "50000plus":
              priceOnAsking = true;
              break;
          }
        } else { // more than 3 items
          if (totalValue === "0-10000") {
            total += 90;
          } else {
            priceOnAsking = true;
          }
        }
        if (priceOnAsking) {
          resultMessage.innerHTML = "Price on Asking";
          document.getElementById('calculatorForm').style.display = "none";
          return;
        }
        // Second person requirement cost
        const secondPerson = document.querySelector('input[name="privateSecondPerson"]:checked');
        if (secondPerson) {
          if (secondPerson.value === "advisable") {
            total += 250;
          } else if (secondPerson.value === "essential") {
            total += 500;
          }
        }
        // Additional cost for extra items (beyond the first)
        const additional = numItems - 1;
        if (additional > 0 && secondPerson) {
          let multiplier = 0;
          if (secondPerson.value === "no") {
            if (itemTypeElem.value === "artwork" || itemTypeElem.value === "object") {
              multiplier = 10;
            } else if (itemTypeElem.value === "furniture" || itemTypeElem.value === "mixed") {
              multiplier = 20;
            }
          } else if (secondPerson.value === "advisable" || secondPerson.value === "essential") {
            multiplier = 25;
          }
          total += additional * multiplier;
        }
        // Crate requirement
        const crateRequired = document.querySelector('input[name="privateCrateRequired"]:checked');
        if (crateRequired && crateRequired.value === "yes") {
          const crateType = document.querySelector('input[name="privateCrateType"]:checked');
          if (crateType) {
            if (crateType.value === "inhouse") {
              // In-house cost depends on total value range
              if (totalValue === "0-10000" || totalValue === "10001-20000" || totalValue === "20001-30000") {
                total += 180;
              } else if (totalValue === "30001-40000" || totalValue === "40001-50000") {
                total += 240;
              }
            } else if (crateType.value === "bespoke") {
              resultMessage.innerHTML = "Price on Asking";
              document.getElementById('calculatorForm').style.display = "none";
              return;
            }
          }
        }
        // Trip Type adjustment
        const tripType = document.querySelector('input[name="privateTripType"]:checked');
        if (tripType && tripType.value === "roundtrip") {
          total *= 2;
        }
      }
      // INSURANCE CALCULATIONS (unchanged)
      else if (insuranceCheckbox.checked) {
        const insuranceSurge = document.querySelector('input[name="insuranceSurge"]:checked');
        if (insuranceSurge && insuranceSurge.value === "yes") {
          total += 400;
        }
        const insuranceNormalRoute = document.querySelector('input[name="insuranceNormalRoute"]:checked');
        if (insuranceNormalRoute) {
          if (insuranceNormalRoute.value === "no") {
            // Use dedicated collection details
            const numVans = parseFloat(document.getElementById('insuranceNumVans').value) || 0;
            const numPeople = parseFloat(document.getElementById('insuranceNumPeople').value) || 0;
            total += (numVans * 1000) + (numPeople * 500);
          } else {
            // Normal route: use standard collection details
            const insuranceSecondPerson = document.querySelector('input[name="insuranceSecondPerson"]:checked');
            if (insuranceSecondPerson) {
              if (insuranceSecondPerson.value === "advisable") {
                total += 250;
              } else if (insuranceSecondPerson.value === "essential") {
                total += 500;
              }
            }
            const insuranceItemType = document.querySelector('input[name="insuranceItemType"]:checked');
            const insuranceNumItems = parseFloat(document.getElementById('insuranceNumItems').value) || 0;
            if (insuranceItemType && insuranceNumItems > 0) {
              const additionalItems = Math.max(insuranceNumItems - 1, 0);
              if (insuranceSecondPerson) {
                if (insuranceSecondPerson.value === "no") {
                  if (insuranceItemType.value === "artwork" || insuranceItemType.value === "objects") {
                    total += additionalItems * 10;
                  } else if (insuranceItemType.value === "furniture" || insuranceItemType.value === "mixed") {
                    total += additionalItems * 20;
                  }
                } else if (insuranceSecondPerson.value === "advisable" || insuranceSecondPerson.value === "essential") {
                  total += additionalItems * 25;
                }
              }
            }
          }
        }
      }
      // Display the total price in GBP.
      document.getElementById('totalPrice').textContent = total.toFixed(2);
    }
  </script>
</body>
</html>
